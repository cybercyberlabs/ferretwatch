!function(){"use strict";let e=!1;const t=window.FerretWatchUtils||{},n=t.getRiskColor||function(e){return"#ff9800"},o=t.getDarkerRiskColor||function(e){return"#f57c00"},i=t.getBucketProviderIcon||function(){return"â˜ï¸"};function s(e,t,o){const s=document.createElement("div");if(s.style.cssText="text-align: center; font-weight: bold; margin-bottom: 12px; font-size: 15px; color: white;",s.textContent=`${t.emoji} ${t.title}`,e.appendChild(s),t.findings&&t.findings.length>0&&t.findings.forEach((t=>{const o=document.createElement("div");o.style.cssText="margin: 8px 0; padding: 8px; background: rgba(255,255,255,0.1); border-radius: 4px; border-left: 3px solid "+n(t.riskLevel||"medium")+";";const s=document.createElement("div");s.style.cssText="display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;";const r=document.createElement("div");if(r.style.cssText="display: flex; align-items: center; gap: 6px;",t.bucketInfo&&t.bucketInfo.provider){const e=document.createElement("span");e.style.cssText="font-size: 14px;",e.textContent=i(t.bucketInfo.provider),r.appendChild(e)}const c=document.createElement("span");c.style.cssText="font-weight: bold; font-size: 13px;",c.textContent=t.type,r.appendChild(c),s.appendChild(r);const d=document.createElement("span");d.style.cssText=`background: ${n(t.riskLevel||"medium")}; color: white; padding: 2px 6px; border-radius: 12px; font-size: 10px; font-weight: bold;`,d.textContent=(t.riskLevel||"unknown").toUpperCase(),s.appendChild(d),o.appendChild(s);const a=document.createElement("div");a.style.cssText="font-family: monospace; font-size: 12px; color: rgba(255,255,255,0.9); display: flex; justify-content: space-between; align-items: center;";const l=document.createElement("span");if(l.textContent=t.value,a.appendChild(l),t.bucketInfo){const e=document.createElement("button");e.style.cssText="background: rgba(255,255,255,0.2); border: none; color: white; padding: 2px 6px; border-radius: 3px; font-size: 10px; cursor: pointer; margin-left: 8px;",e.textContent="ðŸ“‹ Copy",e.onclick=n=>{n.stopPropagation(),navigator.clipboard.writeText(t.value).then((()=>{e.textContent="âœ“ Copied",setTimeout((()=>e.textContent="ðŸ“‹ Copy"),2e3)})).catch((()=>{e.textContent="âŒ Failed",setTimeout((()=>e.textContent="ðŸ“‹ Copy"),2e3)}))},a.appendChild(e)}if(o.appendChild(a),t.bucketInfo){const e=document.createElement("div");e.style.cssText="font-size: 11px; color: rgba(255,255,255,0.8); margin-top: 4px; padding: 4px; background: rgba(0,0,0,0.2); border-radius: 3px;";const n=`Provider: ${t.bucketInfo.provider.toUpperCase()}`,i=t.bucketInfo.accessible?"ðŸ”“ Public Access":"ðŸ”’ Access Denied",s=t.bucketInfo.region?` | Region: ${t.bucketInfo.region}`:"";e.textContent=`${n} | ${i}${s}`,o.appendChild(e)}else if(t.context&&""!==t.context.trim()&&"N/A"!==t.context){const e=document.createElement("div");e.style.cssText="font-size: 11px; color: rgba(255,255,255,0.7); margin-top: 4px; font-style: italic;",e.textContent=`"${t.context.substring(0,50)}${t.context.length>50?"...":""}"`,o.appendChild(e)}e.appendChild(o)})),t.moreCount>0){const n=document.createElement("div");n.style.cssText="margin: 8px 0; padding: 6px; text-align: center; font-style: italic; color: rgba(255,255,255,0.8); border-top: 1px solid rgba(255,255,255,0.2);",n.textContent=`ðŸ“Š +${t.moreCount} more credential${t.moreCount>1?"s":""} found`,e.appendChild(n)}const r=document.createElement("div");r.style.cssText="margin-top: 12px; padding-top: 8px; border-top: 1px solid rgba(255,255,255,0.3); font-size: 11px; color: rgba(255,255,255,0.8); text-align: center;",r.textContent="ðŸ’¡ Click to dismiss â€¢ Check browser console for full details",e.appendChild(r)}function r(t,i="medium"){const r=undefined;document.querySelectorAll(".cyber-labs-credential-notification").forEach((e=>e.remove()));const c=document.createElement("div");if(c.className="cyber-labs-credential-notification","string"==typeof t?c.textContent=t:t&&"object"==typeof t&&s(c,t,i),Object.assign(c.style,{position:"fixed",top:"20px",right:"20px",background:`linear-gradient(135deg, ${n(i)}, ${o(i)})`,color:"#fff",padding:"16px 20px",borderRadius:"12px",zIndex:"10000",boxShadow:"0 8px 32px rgba(0,0,0,0.3), 0 4px 16px rgba(0,0,0,0.2)",maxWidth:"420px",minWidth:"320px",fontSize:"13px",lineHeight:"1.5",cursor:"pointer",fontFamily:"system-ui, -apple-system, sans-serif",border:"1px solid rgba(255,255,255,0.2)",backdropFilter:"blur(10px)",transition:"all 0.3s ease",animation:"slideInRight 0.3s ease-out"}),!document.getElementById("ferretwatch-animations")){const e=document.createElement("style");e.id="ferretwatch-animations",e.textContent="\n                @keyframes slideInRight {\n                    from {\n                        transform: translateX(100%);\n                        opacity: 0;\n                    }\n                    to {\n                        transform: translateX(0);\n                        opacity: 1;\n                    }\n                }\n\n                @keyframes slideOutRight {\n                    from {\n                        transform: translateX(0);\n                        opacity: 1;\n                    }\n                    to {\n                        transform: translateX(100%);\n                        opacity: 0;\n                    }\n                }\n\n                .cyber-labs-credential-notification:hover {\n                    transform: translateY(-2px) !important;\n                    box-shadow: 0 12px 40px rgba(0,0,0,0.4), 0 6px 20px rgba(0,0,0,0.3) !important;\n                }\n            ",document.head.appendChild(e)}c.addEventListener("click",(()=>{c.style.animation="slideOutRight 0.3s ease-in forwards",setTimeout((()=>{c.parentNode&&c.remove()}),300),e=!0})),setTimeout((()=>{c.parentNode&&(c.style.animation="slideOutRight 0.3s ease-in forwards",setTimeout((()=>{c.parentNode&&c.remove()}),300))}),12e3),document.body.appendChild(c)}function c(e,t){const n=e.filter((e=>!0===e.bucketInfo?.accessible)),o=e.filter((e=>!1===e.bucketInfo?.accessible)),i=e.reduce(((e,t)=>{const n=["low","medium","high","critical"],o=t.riskLevel||"unknown",i=undefined,s=undefined;return n.indexOf(o)>n.indexOf(e)?o:e}),"low");let s,c="â˜ï¸";n.length>0?(c="ðŸš¨",s=t.some((e=>!0===e.bucketInfo?.accessible))?`ðŸ†• ${n.length} Public Cloud Bucket${n.length>1?"s":""} Found`:`ðŸš¨ ${n.length} Public Cloud Bucket${n.length>1?"s":""} Detected`):s=t.length>0?`ðŸ†• ${e.length} Cloud Bucket${e.length>1?"s":""} Found`:`â˜ï¸ ${e.length} Cloud Bucket${e.length>1?"s":""} Detected`;const d=undefined,a=undefined;r({emoji:c,title:s,findings:[...n,...o].slice(0,3),moreCount:e.length>3?e.length-3:0},i)}function d(e,t){const n=e.reduce(((e,t)=>{const n=["low","medium","high","critical"],o=t.riskLevel||"unknown",i=undefined,s=undefined;return n.indexOf(o)>n.indexOf(e)?o:e}),"low"),o=undefined,i=undefined,s=undefined,c=undefined;r({emoji:{critical:"ðŸ”¥",high:"âš ï¸",medium:"ðŸ“‹",low:"ðŸ“",unknown:"â“"}[n]||"ðŸ“‹",title:t.length>0?`ðŸ†• ${t.length} New Credential${t.length>1?"s":""} Found`:`ðŸš¨ ${e.length} Credential${e.length>1?"s":""} Detected`,findings:(t.length>0?t:e).slice(0,3),moreCount:e.length>3?e.length-3:0},n)}function a(){e=!1}function l(){return e}window.FerretWatchNotifications={showNotification:r,showBucketNotification:c,showRegularNotification:d,buildNotificationContent:s,resetNotificationDismissed:a,isNotificationDismissed:l}}();