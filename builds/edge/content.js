!function(){"use strict";let e=new Set,t=!1;window.isValidSecret=function(e,t){if(!e)return!1;if(window.FALSE_POSITIVE_PATTERNS)for(const t of window.FALSE_POSITIVE_PATTERNS)if(t.test(e))return!1;return!0};let n=!1,o=[];const i=new ProgressiveScanner;let s=[],r=window.location.hostname;async function c(){try{if("undefined"!=typeof browser&&browser.storage){const e=await browser.storage.local.get(["whitelistedDomains"]);s=e.whitelistedDomains||[],console.log("[FW Content] Whitelist loaded:",s)}}catch(e){console.log("[FW Content] Could not load whitelist, using empty list:",e),s=[]}}function a(){const e=s.some((e=>{if(e.startsWith("*.")){const t=e.substring(2);return r===t||r.endsWith("."+t)}return r===e}));return console.log(`[FW Content] Domain whitelist check for "${r}": ${e}`),e}function l(){if(console.log("[FW Content] injectInterceptor() called"),a())console.log("[FW Content] Skipping interceptor injection - domain is whitelisted");else if(t)console.log("[FW Content] Interceptor already injected by this content script - skipping");else try{console.log("[FW Content] Creating interceptor script element...");const e=document.createElement("script");e.src=("undefined"!=typeof chrome?chrome:browser).runtime.getURL("utils/network-interceptor.js"),e.onload=function(){console.log("[FW Content] Interceptor script loaded and executed"),this.remove()},e.onerror=function(e){console.error("[FW Content] Interceptor script failed to load:",e)},(document.head||document.documentElement).appendChild(e),t=!0,console.log("[FW Content] Interceptor script element appended to DOM"),g("Network interceptor injected")}catch(e){console.error("[FW Content] Failed to inject interceptor:",e)}}function d(e,t,n){const o=document.createElement("div");if(o.style.cssText="text-align: center; font-weight: bold; margin-bottom: 12px; font-size: 15px; color: white;",o.textContent=`${t.emoji} ${t.title}`,e.appendChild(o),t.findings&&t.findings.length>0&&t.findings.forEach((t=>{const n=document.createElement("div");n.style.cssText="margin: 8px 0; padding: 8px; background: rgba(255,255,255,0.1); border-radius: 4px; border-left: 3px solid "+u(t.riskLevel||"medium")+";";const o=document.createElement("div");o.style.cssText="display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;";const i=document.createElement("div");if(i.style.cssText="display: flex; align-items: center; gap: 6px;",t.bucketInfo&&t.bucketInfo.provider){const e=document.createElement("span");e.style.cssText="font-size: 14px;",e.textContent=m(t.bucketInfo.provider),i.appendChild(e)}const s=document.createElement("span");s.style.cssText="font-weight: bold; font-size: 13px;",s.textContent=t.type,i.appendChild(s),o.appendChild(i);const r=document.createElement("span");r.style.cssText=`background: ${u(t.riskLevel||"medium")}; color: white; padding: 2px 6px; border-radius: 12px; font-size: 10px; font-weight: bold;`,r.textContent=(t.riskLevel||"unknown").toUpperCase(),o.appendChild(r),n.appendChild(o);const c=document.createElement("div");c.style.cssText="font-family: monospace; font-size: 12px; color: rgba(255,255,255,0.9); display: flex; justify-content: space-between; align-items: center;";const a=document.createElement("span");if(a.textContent=t.value,c.appendChild(a),t.bucketInfo){const e=document.createElement("button");e.style.cssText="background: rgba(255,255,255,0.2); border: none; color: white; padding: 2px 6px; border-radius: 3px; font-size: 10px; cursor: pointer; margin-left: 8px;",e.textContent="ðŸ“‹ Copy",e.onclick=n=>{n.stopPropagation(),navigator.clipboard.writeText(t.value).then((()=>{e.textContent="âœ“ Copied",setTimeout((()=>e.textContent="ðŸ“‹ Copy"),2e3)})).catch((()=>{e.textContent="âŒ Failed",setTimeout((()=>e.textContent="ðŸ“‹ Copy"),2e3)}))},c.appendChild(e)}if(n.appendChild(c),t.bucketInfo){const e=document.createElement("div");e.style.cssText="font-size: 11px; color: rgba(255,255,255,0.8); margin-top: 4px; padding: 4px; background: rgba(0,0,0,0.2); border-radius: 3px;";const o=`Provider: ${t.bucketInfo.provider.toUpperCase()}`,i=t.bucketInfo.accessible?"ðŸ”“ Public Access":"ðŸ”’ Access Denied",s=t.bucketInfo.region?` | Region: ${t.bucketInfo.region}`:"";e.textContent=`${o} | ${i}${s}`,n.appendChild(e)}else if(t.context&&""!==t.context.trim()&&"N/A"!==t.context){const e=document.createElement("div");e.style.cssText="font-size: 11px; color: rgba(255,255,255,0.7); margin-top: 4px; font-style: italic;",e.textContent=`"${t.context.substring(0,50)}${t.context.length>50?"...":""}"`,n.appendChild(e)}e.appendChild(n)})),t.moreCount>0){const n=document.createElement("div");n.style.cssText="margin: 8px 0; padding: 6px; text-align: center; font-style: italic; color: rgba(255,255,255,0.8); border-top: 1px solid rgba(255,255,255,0.2);",n.textContent=`ðŸ“Š +${t.moreCount} more credential${t.moreCount>1?"s":""} found`,e.appendChild(n)}const i=document.createElement("div");i.style.cssText="margin-top: 12px; padding-top: 8px; border-top: 1px solid rgba(255,255,255,0.3); font-size: 11px; color: rgba(255,255,255,0.8); text-align: center;",i.textContent="ðŸ’¡ Click to dismiss â€¢ Check browser console for full details",e.appendChild(i)}function u(e){const t={critical:"#d32f2f",high:"#f57c00",medium:"#7b1fa2",low:"#388e3c"};return t[e]||t.medium}function g(e,...t){window.StorageUtils?.getSetting("debugMode",!1)&&console.log(`[Content Debug] ${e}`,...t)}function p(e,...t){console.log(`[FerretWatch] ${e}`,...t)}function f(e){const t={critical:"#b71c1c",high:"#e65100",medium:"#4a148c",low:"#1b5e20"};return t[e]||t.medium}function m(e){const t=undefined;return{aws:"â˜ï¸",gcp:"ðŸŒ",azure:"ðŸ”·",digitalocean:"ðŸŒŠ",alibaba:"ðŸ®"}[e]||"â˜ï¸"}function h(e,t="medium"){const o=undefined;document.querySelectorAll(".cyber-labs-credential-notification").forEach((e=>e.remove()));const i=document.createElement("div");if(i.className="cyber-labs-credential-notification","string"==typeof e?i.textContent=e:e&&"object"==typeof e&&d(i,e,t),Object.assign(i.style,{position:"fixed",top:"20px",right:"20px",background:`linear-gradient(135deg, ${u(t)}, ${f(t)})`,color:"#fff",padding:"16px 20px",borderRadius:"12px",zIndex:"10000",boxShadow:"0 8px 32px rgba(0,0,0,0.3), 0 4px 16px rgba(0,0,0,0.2)",maxWidth:"420px",minWidth:"320px",fontSize:"13px",lineHeight:"1.5",cursor:"pointer",fontFamily:"system-ui, -apple-system, sans-serif",border:"1px solid rgba(255,255,255,0.2)",backdropFilter:"blur(10px)",transition:"all 0.3s ease",animation:"slideInRight 0.3s ease-out"}),!document.getElementById("ferretwatch-animations")){const e=document.createElement("style");e.id="ferretwatch-animations",e.textContent="\n                @keyframes slideInRight {\n                    from {\n                        transform: translateX(100%);\n                        opacity: 0;\n                    }\n                    to {\n                        transform: translateX(0);\n                        opacity: 1;\n                    }\n                }\n                \n                @keyframes slideOutRight {\n                    from {\n                        transform: translateX(0);\n                        opacity: 1;\n                    }\n                    to {\n                        transform: translateX(100%);\n                        opacity: 0;\n                    }\n                }\n                \n                .cyber-labs-credential-notification:hover {\n                    transform: translateY(-2px) !important;\n                    box-shadow: 0 12px 40px rgba(0,0,0,0.4), 0 6px 20px rgba(0,0,0,0.3) !important;\n                }\n            ",document.head.appendChild(e)}i.addEventListener("click",(()=>{i.style.animation="slideOutRight 0.3s ease-in forwards",setTimeout((()=>{i.parentNode&&i.remove()}),300),n=!0})),setTimeout((()=>{i.parentNode&&(i.style.animation="slideOutRight 0.3s ease-in forwards",setTimeout((()=>{i.parentNode&&i.remove()}),300))}),12e3),document.body.appendChild(i)}function w(t){if(o=t.map((e=>({...e,timestamp:(new Date).toISOString(),url:window.location.href,domain:window.location.hostname}))),window.lastScanResults=o,0===t.length)return void p("âœ… No security issues found on this page.");const i=t.filter((e=>e.bucketInfo)),s=t.filter((e=>!e.bucketInfo)),r=t.filter((e=>"critical"===e.riskLevel)).length,c=t.filter((e=>"high"===e.riskLevel)).length,a=t.filter((e=>"medium"===e.riskLevel)).length;p(r>0||c>0?`ðŸš¨ SECURITY ALERT: Found ${r+c} high-risk issue(s) on ${window.location.hostname}`:a>0?`âš ï¸ Found ${a} medium-risk issue(s) on ${window.location.hostname}`:`â„¹ï¸ Found ${t.length} low-risk issue(s) on ${window.location.hostname}`);const l=undefined;t.filter((e=>["critical","high","medium"].includes(e.riskLevel))).forEach(((e,t)=>{const n={critical:"ðŸ”¥",high:"ðŸš¨",medium:"âš ï¸",low:"â„¹ï¸"}[e.riskLevel]||"â“";if(e.bucketInfo){const t=e.bucketInfo.testResults?.listingEnabled?"PUBLIC LISTING":e.bucketInfo.testResults?.accessible?"ACCESSIBLE":"SECURED";p(`${n} ${e.type}: ${e.fullUrl||e.value} (${t})`)}else p(`${n} ${e.type}: ${e.value}`)}));const d=t.filter((e=>"low"===e.riskLevel));d.length>0&&(g(`Found ${d.length} low-risk findings:`),d.forEach((e=>{e.bucketInfo?g(`  â„¹ï¸ ${e.type}: ${e.fullUrl||e.value} (SECURED)`):g(`  â„¹ï¸ ${e.type}: ${e.value}`)}))),window.StorageUtils?.getSetting("debugMode",!1)&&(console.log("%cðŸš¨ FERRETWATCH SECURITY SCAN RESULTS ðŸš¨","color: white; background: #d32f2f; font-weight: bold; padding: 8px; border-radius: 4px; font-size: 16px;"),console.log(`%cðŸ“ Domain: ${window.location.hostname}`,"color: #1976d2; font-weight: bold;"),console.log(`%cðŸ” Found ${t.length} potential security issue${t.length>1?"s":""}`,"color: #d32f2f; font-weight: bold; font-size: 14px;"),i.length>0&&console.log(`%câ˜ï¸ Cloud Buckets: ${i.length} found`,"color: #ff9800; font-weight: bold;"),s.length>0&&console.log(`%cðŸ” Credentials: ${s.length} found`,"color: #d32f2f; font-weight: bold;"),console.log("%c"+"â•".repeat(80),"color: #666;")),window.StorageUtils?.getSetting("debugMode",!1)&&t.forEach(((e,t)=>{const n=e.riskLevel||"unknown",o=u(n),i={critical:"ðŸ”¥",high:"âš ï¸",medium:"ðŸ“‹",low:"ðŸ“",unknown:"â“"}[n]||"â“";console.log(`%c${i} FINDING #${t+1}`,`color: white; background: ${o}; font-weight: bold; padding: 4px 8px; border-radius: 3px;`),console.log(`%c   ðŸ“ Type: ${e.type}`,"color: #333; font-weight: bold;"),e.bucketInfo?(console.log(`%c   â˜ï¸ Bucket: ${e.value}`,"color: #666;"),console.log(`%c   ðŸ¢ Provider: ${e.bucketInfo.provider.toUpperCase()}`,"color: #666;"),console.log("%c   ðŸ”“ Access: "+(e.bucketInfo.accessible?"Public":"Denied"),`color: ${e.bucketInfo.accessible?"#d32f2f":"#388e3c"};`),e.bucketInfo.region&&console.log(`%c   ðŸŒ Region: ${e.bucketInfo.region}`,"color: #666;")):console.log(`%c   ðŸ” Value: ${e.value}`,"color: #666;"),console.log(`%c   âš¡ Risk: ${n.toUpperCase()}`,`color: ${o}; font-weight: bold;`),e.context&&""!==e.context.trim()&&"N/A"!==e.context?console.log(`%c   ðŸ“ Context: "${e.context.substring(0,120)}${e.context.length>120?"...":""}"`,"color: #795548; font-style: italic;"):console.log("%c   ðŸ“ Context: Not available","color: #999; font-style: italic;"),console.log("%c"+"â”€".repeat(60),"color: #ddd;")}));const f=t.filter((t=>!e.has(t.type+"|"+t.value)));t.forEach((t=>e.add(t.type+"|"+t.value)));const m=f.filter((e=>"low"!==(e.riskLevel||"medium")));if(m.length>0||!n){const e=m.filter((e=>e.bucketInfo)),t=m.filter((e=>!e.bucketInfo)),n=i.filter((e=>"low"!==(e.riskLevel||"medium")));n.length>0&&b(n,e);const o=s.filter((e=>"low"!==(e.riskLevel||"medium")));o.length>0&&y(o,t)}else g("Same findings detected (notification dismissed - check console for details)");const h=f.filter((e=>"low"===(e.riskLevel||"medium")));h.length>0&&g(`${h.length} low-risk finding(s) detected (informational only - not shown in popup)`)}function b(e,t){const n=e.filter((e=>!0===e.bucketInfo?.accessible)),o=e.filter((e=>!1===e.bucketInfo?.accessible)),i=e.reduce(((e,t)=>{const n=["low","medium","high","critical"],o=t.riskLevel||"unknown",i=undefined,s=undefined;return n.indexOf(o)>n.indexOf(e)?o:e}),"low");let s,r="â˜ï¸";n.length>0?(r="ðŸš¨",s=t.some((e=>!0===e.bucketInfo?.accessible))?`ðŸ†• ${n.length} Public Cloud Bucket${n.length>1?"s":""} Found`:`ðŸš¨ ${n.length} Public Cloud Bucket${n.length>1?"s":""} Detected`):s=t.length>0?`ðŸ†• ${e.length} Cloud Bucket${e.length>1?"s":""} Found`:`â˜ï¸ ${e.length} Cloud Bucket${e.length>1?"s":""} Detected`;const c=undefined,a=undefined;h({emoji:r,title:s,findings:[...n,...o].slice(0,3),moreCount:e.length>3?e.length-3:0},i)}function y(e,t){const n=e.reduce(((e,t)=>{const n=["low","medium","high","critical"],o=t.riskLevel||"unknown",i=undefined,s=undefined;return n.indexOf(o)>n.indexOf(e)?o:e}),"low"),o=undefined,i=undefined,s=undefined,r=undefined;h({emoji:{critical:"ðŸ”¥",high:"âš ï¸",medium:"ðŸ“‹",low:"ðŸ“",unknown:"â“"}[n]||"ðŸ“‹",title:t.length>0?`ðŸ†• ${t.length} New Credential${t.length>1?"s":""} Found`:`ðŸš¨ ${e.length} Credential${e.length>1?"s":""} Detected`,findings:(t.length>0?t:e).slice(0,3),moreCount:e.length>3?e.length-3:0},n)}async function x(){const e=[];for(const t in window.SECURITY_PATTERNS)for(const n in window.SECURITY_PATTERNS[t]){const o=window.SECURITY_PATTERNS[t][n];o.pattern&&e.push({regex:o.pattern,type:o.description,risk:o.riskLevel,riskLevel:o.riskLevel,category:o.category||t,provider:o.provider})}const t=document.documentElement.innerHTML;let n=await i.progressiveScan(t,e);if(i.isBucketScanningEnabled&&"function"==typeof i.isBucketScanningEnabled&&i.isBucketScanningEnabled())try{const e=await i.scanCloudBuckets(n);if(e&&e.length>0){const t=n.filter((e=>!e.category||"cloudStorage"!==e.category));n=[...t,...e]}}catch(e){g("Bucket scanning failed:",e)}return w(n),n}async function C(){try{if(console.log("[FW Content] Early initialization at document_start"),await c(),a())return void console.log("[FW Content] Domain is whitelisted - skipping interceptor injection");l(),console.log("[FW Content] Interceptor injected at document_start")}catch(e){console.error("[FW Content] Early injection error:",e)}}async function E(){try{if(console.log("[FW Content] Initializing FerretWatch scanner on domain:",r),await S(),a())return void console.log("[FW Content] FerretWatch disabled for whitelisted domain:",r);console.log("[FW Content] FerretWatch starting scan on:",r),g("FerretWatch Auto-scanning for credentials..."),await x()}catch(e){console.error("[FW Content] Initialization error:",e)}}window.addEventListener("message",(function(e){if(e.source===window){if(e.data&&"FERRETWATCH_API_CALL"===e.data.type){const t=e.data.data;console.log(`[FW Content] API call received from interceptor: ${t.method} ${t.url}`),g(`[Content] API call captured: ${t.method} ${t.url}`),"undefined"!=typeof chrome&&chrome.runtime?chrome.runtime.sendMessage({type:"API_CALL_CAPTURED",data:t},(e=>{chrome.runtime.lastError?console.error("[FW Content] Error sending to background:",chrome.runtime.lastError):console.log("[FW Content] Message sent to background successfully")})):"undefined"!=typeof browser&&browser.runtime&&browser.runtime.sendMessage({type:"API_CALL_CAPTURED",data:t}).then((()=>{console.log("[FW Content] Message sent to background successfully")})).catch((e=>{console.error("[FW Content] Error sending to background:",e)}))}if(e.data&&"FERRETWATCH_API_RESPONSE"===e.data.type){const t=e.data.data;console.log(`[FW Content] API response received from interceptor: ${t.status} ${t.method} ${t.url}`),g(`[Content] API response captured: ${t.status} ${t.method} ${t.url}`),"undefined"!=typeof chrome&&chrome.runtime?chrome.runtime.sendMessage({type:"API_RESPONSE_CAPTURED",data:t},(e=>{chrome.runtime.lastError?console.error("[FW Content] Error sending response to background:",chrome.runtime.lastError):console.log("[FW Content] Response sent to background successfully")})):"undefined"!=typeof browser&&browser.runtime&&browser.runtime.sendMessage({type:"API_RESPONSE_CAPTURED",data:t}).then((()=>{console.log("[FW Content] Response sent to background successfully")})).catch((e=>{console.error("[FW Content] Error sending response to background:",e)}))}}})),console.log("[FW Content] Message listener registered for window.postMessage"),C(),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",E):setTimeout(E,100);const k=("undefined"!=typeof browser?browser:chrome).runtime;k&&k.onMessage.addListener(((e,t,i)=>{if("executeRequest"===e.action)return(async()=>{const{url:t,method:n,headers:o,body:s}=e.data;if("undefined"!=typeof exportFunction&&window.wrappedJSObject)try{p(`Executing proxied request (Firefox Xray): ${n} ${t}`);const e=["host","connection","origin","referer","content-length","cookie","date","user-agent","dnt","upgrade-insecure-requests","sec-fetch-user","sec-fetch-site","sec-fetch-mode","sec-fetch-dest"],r={};if(o)for(const[t,n]of Object.entries(o))e.includes(t.toLowerCase())||(r[t]=n);const c=async e=>{const o={method:n||"GET",headers:r,credentials:e};s&&!["GET","HEAD"].includes(o.method.toUpperCase())&&(o.body="object"==typeof s?JSON.stringify(s):s);const i=cloneInto(o,window.wrappedJSObject);return await window.wrappedJSObject.fetch(t,i)};let a;try{a=await c("include")}catch(e){a=await c("omit")}let l="";try{l=await a.text()}catch(e){l="[Body Read Error]"}return i({success:!0,status:a.status,statusText:a.statusText,headers:[],body:l}),!0}catch(e){console.warn("Firefox Xray failed, falling back to external script approach:",e.message)}const r="fw-"+Math.random().toString(36).substr(2,9);try{p(`Executing proxied request (Main World via External Script): ${n} ${t}`);const e=["host","connection","origin","referer","content-length","cookie","date","user-agent","dnt","upgrade-insecure-requests","sec-fetch-user","sec-fetch-site","sec-fetch-mode","sec-fetch-dest"],c={};if(o)for(const[t,n]of Object.entries(o))e.includes(t.toLowerCase())||(c[t]=n);const a=new Promise(((e,t)=>{const n=setTimeout((()=>{window.removeEventListener(r,o),t(new Error("Main World Request Timed Out"))}),3e4),o=i=>{window.removeEventListener(r,o),clearTimeout(n);const s=i.detail;s.success?e(s.response):t(new Error(s.error))};window.addEventListener(r,o)}));if(!document.querySelector("script[data-ferretwatch-proxy]")){const e=document.createElement("script");e.src=("undefined"!=typeof chrome?chrome:browser).runtime.getURL("utils/main-world-proxy.js"),e.dataset.ferretwatchProxy="true",e.onload=function(){g("Main world proxy script loaded successfully")},e.onerror=function(){console.error("Failed to load main world proxy script")},(document.head||document.documentElement).appendChild(e),await new Promise((e=>setTimeout(e,100)))}const l={method:n||"GET",headers:c};s&&!["GET","HEAD"].includes((n||"GET").toUpperCase())&&(l.body=s),window.dispatchEvent(new CustomEvent("ferretwatch-proxy-request",{detail:{requestId:r,url:t,options:l}}));const d=await a;i(d)}catch(e){console.error("Content Script Proxy Error:",e),i({success:!1,error:`Proxy Error: ${e.message}`})}})(),!0;if("rescan"===e.action)return(async()=>{if(await c(),a())return void i({success:!1,error:"Domain is whitelisted"});n=!1;const e=await x();i({success:!0,findings:e})})(),!0;if("getCurrentFindings"===e.action){const e=o.length>0?o:window.lastScanResults||[];return i({success:!0,findings:e}),!0}return"addToWhitelist"===e.action?((async()=>{try{await c();const t=e.domain||r,n=undefined,o=e.includeSubdomains||!1?"*."+t:t;s.includes(o)||(s.push(o),await browser.storage.local.set({whitelistedDomains:s})),i({success:!0,domain:o})}catch(e){i({success:!1,error:e.message})}})(),!0):"removeFromWhitelist"===e.action?((async()=>{try{await c();const t=e.domain;s=s.filter((e=>e!==t)),await browser.storage.local.set({whitelistedDomains:s}),i({success:!0})}catch(e){i({success:!1,error:e.message})}})(),!0):"getWhitelist"===e.action?((async()=>{await c(),i({success:!0,whitelist:s,currentDomain:r,isWhitelisted:a()})})(),!0):"scanUnusedEndpoints"!==e.action||((async()=>{try{if("undefined"==typeof EndpointScanner)return void i({success:!1,error:"EndpointScanner not loaded"});g("[Content] Starting endpoint scan...");const e=new EndpointScanner,t=await e.scanPage();g(`[Content] Scan complete: ${t.total} endpoints found`),i({success:!0,discovered:t.endpoints,total:t.total,scannedAt:t.scannedAt})}catch(e){console.error("[FW] Endpoint scan error:",e),i({success:!1,error:e.message})}})(),!0)})),window.ProgressiveScanner=ProgressiveScanner,window.SECURITY_PATTERNS=window.SECURITY_PATTERNS;let v={maxFindings:50,scanningMode:"progressive",scanDelay:500,enableDebounce:!0,enabledCategories:{aws:!0,github:!0,slack:!0,discord:!0,apiKeys:!0,azure:!0,gcp:!0,jwt:!0,services:!0,passwords:!0,keys_and_certificates:!0,database:!0,environment:!0},cloudBucketScanning:{enabled:!0,providers:{aws:!0,gcp:!0,azure:!0,digitalocean:!0,alibaba:!0},testTimeout:5e3,maxConcurrentTests:3,testPublicAccess:!0}};async function S(){try{const e=await browser.storage.local.get(["userSettings","debugMode"]);e.userSettings&&(v={...v,...e.userSettings}),void 0!==e.debugMode&&(v.debugMode=e.debugMode)}catch(e){g("Failed to load settings:",e)}}window.StorageUtils={get:async e=>{const t=undefined;return(await browser.storage.local.get([e]))[e]||null},set:async(e,t)=>{await browser.storage.local.set({[e]:t})},remove:async e=>{await browser.storage.local.remove([e])},isDomainWhitelisted:(e=null)=>{const t=e||r;return s.some((e=>{if(e.startsWith("*.")){const n=e.substring(2);return t===n||t.endsWith("."+n)}return t===e}))},getSetting:(e,t=null)=>void 0!==v[e]?v[e]:t,isCategoryEnabled:e=>{const t=undefined;return!1!==(v.enabledCategories||{})[e]},getBucketScanningSettings:()=>v.cloudBucketScanning||{enabled:!0,providers:{aws:!0,gcp:!0,azure:!0,digitalocean:!0,alibaba:!0},testTimeout:5e3,maxConcurrentTests:3,testPublicAccess:!0},isBucketScanningEnabled:()=>{const e=v.cloudBucketScanning;return e&&!0===e.enabled},isProviderEnabled:e=>{const t=v.cloudBucketScanning;return t&&t.providers&&!0===t.providers[e]}},window.FerretWatchDebug={version:"2.2.0",scanCurrentPage:async()=>{const e=undefined;return await x()},getLastScanResults:()=>o},window.scanner=i,window.lastScanResults=o}();